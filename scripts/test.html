<!DOCTYPE html>
<html>
	<head>
            <title>Test</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
            <style>
                  .image-test {
                        width: 90%;
                  }

                  .city-name-test {
                        text-align: left;
                        font-size: 30px;
                        color: blue;
                  }

                  .title-test {
                        text-align: center;
                        font-size: 20px;
                        color: red;
                  }

                  .checked-block-style {
                        color: rgb(204, 0, 95);
                  }

                  .result-box {
                        width: 300px;
                        height: 300px;
                        background-color: grey;
                  }

            </style>
		<script>
                  window.onload = function() {
                       
                        //объекты с данными по городам - название, изображение
                        const minsk = {
                              name: "Минск",
                              src: "../images/img/minsk.jpg",    
                              image: new Image,                   
                        }
                        
                        const novogrudok = {
                              name: "Новогрудок",
                              src: "../images/img/novogrudok.jpg",    
                              image: new Image,                  
                        }

                        const mir = {
                              name: "Мир",
                              src: "../images/img/mir.jpg",    
                              image: new Image,                
                        }

                        const nesvizh = {
                              name: "Несвиж",
                              src: "../images/img/nesvizh.jpg",    
                              image: new Image,               
                        }

                        //установка источника изображения для городов
                        minsk.image.src = minsk.src;
                        novogrudok.image.src = novogrudok.src;
                        mir.image.src = mir.src;
                        nesvizh.image.src = nesvizh.src;

                        //клик по кнопке - выбор ответа и стилизация

                        let points = document.querySelectorAll("input");
                        points.forEach(function(input) {
                              input.onclick = function() {
                                    input.classList.toggle("checked"); //добавление-удаление класса input
                                    let blockChecked = input.parentElement;
                                    console.log(blockChecked);
                                    blockChecked.classList.toggle("checked-block-style"); //добавление-удаление класса div
                              };
                        })

                        //обработка результатов теста. Доступ к кнопке, запуск функции при клике на "Отправить"

                        let done = document.querySelector("#submit");
                        done.addEventListener("click",countAnswers);

                        function countAnswers() {
                              console.log("Запуск функции подсчета");
                             
                              //начальные значения счетчиков по городам
                              let countMinsk = 0;
                              let countMir = 0;
                              let countNesvizh = 0;
                              let countNovogrudok = 0;
                              
                              //создание массива из всех блоков с выбранными элементами
                              const answ = document.querySelectorAll(".checked-block-style");

                              //перебор массива, поиск соответствующих классов и увеличение счетчиков
                              for (let i=0; i<answ.length; i++) {
                              if(answ[i].classList.contains("minsk")) { countMinsk += 1; }
                              if(answ[i].classList.contains("mir")) { countMir += 1; }
                              if(answ[i].classList.contains("nesvizh")) { countNesvizh += 1; }
                              if(answ[i].classList.contains("novogrudok")) { countNovogrudok += 1; }
                              }

                              console.log(`Результаты подсчета: Минск(${countMinsk}), Мир(${countMir}), Несвиж(${countNesvizh}), Новогрудок(${countNovogrudok})`);
                              
                              //счетчики ответов (примеры)
                              /*let countMinsk = 2;
                              let countMir = 3;
                              let countNesvizh = 1;
                              let countNovogrudok = 2;*/

                              //вывод результата
                              
                              //создание массива из результатов теста
                              const arr = [countMinsk,countMir,countNesvizh,countNovogrudok];

                              //максимальное значение из 4х значений
                              let maxValue = Math.max(countMinsk,countMir,countNesvizh,countNovogrudok);

                              //индекс максимального значения в массиве
                              let ind = arr.indexOf(maxValue)

                              //получение названия переменной в качестве результата
                              function switchResult(index){   
                                          switch (index) {
                                          case 0: return "countMinsk";
                                          case 1: return "countMir";
                                          case 2: return "countNesvizh";
                                          case 3: return "countNovogrudok";
                                    }
                              }
                              let result = switchResult(ind);

                              //функция-сборка названия и изображения города для вывода результата
                              const showResult = function () {
                                    console.log("Запуск функции сборки");
                                    let resultBox = document.querySelector(".result-box");            //доступ к контейнеру выгрузки!!

                                    let nameElement = document.createElement("p"); //вывод имени
                                    nameElement.className = "city-name-test";
                                    nameElement.textContent = `${this.name}`;
                                    resultBox.prepend(nameElement);

                                    let title = document.createElement("p"); //вывод заголовка
                                    title.className = "title-test";
                                    title.textContent = "Ваш город:";
                                    resultBox.prepend(title);

                                    let imgElement = document.createElement("img"); //вывод фото
                                    imgElement.className = "image-test";
                                    imgElement.setAttribute("src",`${this.src}`);
                                    resultBox.append(imgElement); 
                              }  

                              //присваивание функции showResult свойству show объектов
                              minsk.show = showResult;
                              novogrudok.show = showResult;
                              mir.show = showResult;
                              nesvizh.show = showResult;
                              
                              document.testForm.style.display = "none"; //скрыть форму после ответа
                              done.style.display = "none";               //скрыть кнопку "Ответить"
                              document.querySelector(".task").style.display = "none";           //скрыть заголовок

                              //запуск функции по выводу изображения
                              if(result === `countMinsk`) {
                                    minsk.show();
                              }

                              if(result === `countMir`) {
                                    mir.show();
                              }

                              if(result === `countNesvizh`) {
                                    nesvizh.show();
                              }

                              if(result === `countNovogrudok`) {
                                    novogrudok.show();
                              }

                        }

                  }
		</script>
	</head>
	<body>
            <form method="get" enctype="application/x-www-form-urlencoded" name="testForm">
                  <p class="task">Отметьте пункты, справедливые для вас:</p>
                  <div>
                      <div class="answer minsk">
                              <input type="checkbox" name="minsk" id="check1" value="1">
                              <label for="check1">Я люблю много гулять. Расстояния для меня не проблема.</label>
                      </div>
                      <div class="answer minsk">
                              <input type="checkbox" name="minsk" id="check2" value="1">
                              <label for="check2">Меня привлекает современная архитектура.</label>
                      </div> 
                      <div class="answer minsk">
                              <input type="checkbox" name="minsk" id="check3" value="1">
                              <label for="check3">Каждый турист должен побывать в столице государства, которое посещает.</label>
                      </div>
                      <div class="answer novogrudok">
                              <input type="checkbox" name="novogrudok" id="check4" value="1">
                              <label for="check4">История - моя страсть. В насыщенных на исторические события местах особая атмосфера.</label>
                      </div>
                      <div class="answer novogrudok"> 
                              <input type="checkbox" name="novogrudok" id="check5" value="1">
                              <label for="check5">Я люблю посещать развалины. В них есть что-то трепетное.</label>
                      </div>
                      <div class="answer novogrudok">
                              <input type="checkbox" name="novogrudok" id="check6" value="1">
                              <label for="check6">Организованные экскурсии не для меня.</label>
                      </div>
                      <div class="answer mir">
                              <input type="checkbox" name="mir" id="check7" value="1">
                              <label for="check7">Я люблю посещать музеи, но предпочитаю чтобы все экспозиции были сконцентрированы на незначительной территории.</label>
                      </div>
                      <div class="answer mir">
                              <input type="checkbox" name="mir" id="check8" value="1">
                              <label for="check8">Я предпочитаю замки, а не дворцы и тем более развалины.</label>
                      </div>
                      <div class="answer mir">
                              <input type="checkbox" name="mir" id="check9" value="1">
                              <label for="check9">Удобно, когда достопримечательность располагается прямо у стоянки или остановки.</label>
                      </div>
                      <div class="answer nesvizh">
                              <input type="checkbox" name="nesvizh" id="check10" value="1">
                              <label for="check10">Я люблю посещать музеи. Чем разнообразнее экспозиции - тем лучше.</label>
                      </div>
                      <div class="answer nesvizh">
                              <input type="checkbox" name="nesvizh" id="check11" value="1">
                              <label for="check11">Я предпочитаю дворцы, а не замки или развалины.</label>
                      </div>
                      <div class="answer nesvizh">
                              <input type="checkbox" name="nesvizh" id="check12" value="1">
                              <label for="check12">Наличие парковых зон рядом очень приветствуется.</label>
                      </div>
                  </div>
            </form>
            <button type="submit" form="testForm" name="submit" id="submit">Отправить</button> 
            <div class="result-box"></div>
	</body>
</html>